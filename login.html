<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <title>Ghasiq â€“ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet" />

    <style>
        :root {
            --primary: #2563eb;
            --primary-light: #3b82f6;

            --bg-main: #020617;
            --bg-elevated: rgba(15, 23, 42, 0.94);
            --bg-card: rgba(15, 23, 42, 0.98);
            --border-subtle: rgba(148, 163, 184, 0.35);

            --text-main: #e5e7eb;
            --text-muted: #9ca3af;
        }

        body.light {
            --bg-main: #f5f7fb;
            --bg-elevated: #ffffff;
            --bg-card: #ffffff;
            --border-subtle: rgba(148, 163, 184, 0.5);
            --text-main: #0f172a;
            --text-muted: #6b7280;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: "Cairo", sans-serif;
            background:
                radial-gradient(circle at top left, rgba(37, 99, 235, 0.35), transparent 55%),
                radial-gradient(circle at bottom right, rgba(56, 189, 248, 0.28), transparent 55%),
                linear-gradient(135deg, #00020b, var(--bg-main) 45%, #00010a);
            color: var(--text-main);
            min-height: 100vh;
        }

        .page {
            max-width: 1140px;
            margin: auto;
            padding: 20px 18px 40px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .login-layout {
            display: grid;
            grid-template-columns: 1.2fr .9fr;
            gap: 24px;
            flex: 1;
            align-items: center;
        }

        .login-hero,
        .login-card {
            border-radius: 22px;
            background: var(--bg-elevated);
            border: 1px solid var(--border-subtle);
            padding: 24px;
        }

        .login-title { margin-bottom: 8px; }
        .login-mode-switch { display: flex; gap: 8px; margin-bottom: 12px; }

        .mode-btn {
            flex: 1;
            padding: 7px;
            border-radius: 999px;
            border: 1px solid var(--border-subtle);
            background: var(--bg-card);
            color: var(--text-main);
            cursor: pointer;
        }

        .mode-btn.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border: none;
        }

        .input-group {
            margin-bottom: 14px;
            position: relative;
        }

        .input-group label {
            font-size: 13px;
            margin-bottom: 4px;
            display: block;
        }

        .input-group input {
            width: 100%;
            padding: 10px 40px 10px 10px;
            border-radius: 10px;
            border: 1px solid var(--border-subtle);
            background: rgba(15, 23, 42, 0.9);
            color: var(--text-main);
            font-size: 14px;
        }

        .toggle-eye {
            position: absolute;
            left: 12px;
            top: 35px;
            font-size: 16px;
            cursor: pointer;
            user-select: none;
            color: #9ca3af;
        }

        .btn-primary {
            width: 100%;
            padding: 10px;
            border-radius: 999px;
            border: none;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            cursor: pointer;
        }

        .error-box {
            display: none;
            margin-bottom: 10px;
            padding: 8px;
            border-radius: 10px;
            background: rgba(239, 68, 68, 0.1);
            color: #fecaca;
        }
    </style>
</head>

<body>
<div class="page">
    <section class="login-layout">
        <article class="login-hero">
            <h1>Ø¯Ø®ÙˆÙ„ Ù…ÙˆØ¸ÙÙŠ Ghasiq Ù„Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ</h1>
            <p>
                Ù‡Ø°Ù‡ Ø§Ù„Ø¨ÙˆØ§Ø¨Ø© Ù…Ø®ØµØµØ© Ù„Ø±Ø¤Ø³Ø§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©.
            </p>
        </article>

        <aside class="login-card">
            <h2 class="login-title">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>

            <div class="login-mode-switch">
                <button type="button" class="mode-btn active" id="modeUserBtn">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</button>
                <button type="button" class="mode-btn" id="modeAdminBtn">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
            </div>

            <div id="errorBox" class="error-box"></div>

            <div class="input-group">
                <label for="username">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                <input id="username" type="text" autocomplete="off" />
            </div>

            <!-- âœ… ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù…Ø¹ Ø²Ø± Ø§Ù„Ø¹ÙŠÙ† -->
            <div class="input-group">
                <label for="password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                <input id="password" type="password" autocomplete="off" />
                <span id="togglePassword" class="toggle-eye">ğŸ‘ï¸</span>
            </div>

            <button class="btn-primary" type="button" onclick="login()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
        </aside>
    </section>
</div>

<script>
/* ===== ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø®ÙˆÙ„ ===== */
let loginMode = "user";
const modeUserBtn = document.getElementById("modeUserBtn");
const modeAdminBtn = document.getElementById("modeAdminBtn");

modeUserBtn.onclick = () => {
    loginMode = "user";
    modeUserBtn.classList.add("active");
    modeAdminBtn.classList.remove("active");
};

modeAdminBtn.onclick = () => {
    loginMode = "admin";
    modeAdminBtn.classList.add("active");
    modeUserBtn.classList.remove("active");
};

/* ===== API ===== */
const API_URL = "https://filesregsiteration.sstli.com/users.php";

/* ===== Login ===== */
async function login() {
    const username = document.getElementById("username").value.trim();
    const password = document.getElementById("password").value.trim();
    const errorBox = document.getElementById("errorBox");

    errorBox.style.display = "none";

    if (!username || !password) {
        errorBox.style.display = "block";
        errorBox.textContent = "Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.";
        return;
    }

    try {
        const res = await fetch(API_URL);
        const json = await res.json();

        const users = json.data.users || [];
        const user = users.find(u => u.username.toLowerCase() === username.toLowerCase());

        if (!user) {
            errorBox.style.display = "block";
            errorBox.textContent = "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± ØµØ­ÙŠØ­.";
            return;
        }

        const userObj = {
            username: user.username,
            role: user.role || (user.is_admin ? "Administrator" : "Employee"),
            isAdmin: !!user.is_admin,
            login: true
        };

        localStorage.setItem("ghasiq_user", JSON.stringify(userObj));

        if (loginMode === "admin") {
            if (!userObj.isAdmin) {
                errorBox.style.display = "block";
                errorBox.textContent = "Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„ÙŠØ³ Ø£Ø¯Ù…Ù†.";
                return;
            }
            window.location.href = "admin-users.html";
        } else {
            window.location.href = "index.html";
        }

    } catch {
        errorBox.style.display = "block";
        errorBox.textContent = "Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„.";
    }
}

/* âœ… Ø²Ø± Ø§Ù„Ø¹ÙŠÙ† */
(function(){
    const passInput = document.getElementById("password");
    const toggleBtn = document.getElementById("togglePassword");

    toggleBtn.onclick = () => {
        if (passInput.type === "password") {
            passInput.type = "text";
            toggleBtn.textContent = "ğŸ™ˆ";
        } else {
            passInput.type = "password";
            toggleBtn.textContent = "ğŸ‘ï¸";
        }
    };
})();
</script>

</body>
</html>
